
## Debian packaging experience

The experience of packaging a Perl library, the same way as contributing to the kernel, was not easy. We based ourselves in two tutorials: [Tutorial 1](https://joenio.me/tutorial-pacote-debian-parte1/) and [Tutorial 2](https://joenio.me/tutorial-pacote-debian-parte2/) where the autor packaged `Acme::HelloWorld` and `Getopt::EX::Hashed` libraries.

The first step was to set up a VM with Debian testing. We used the same VM that was used for the kernel build, only needing to switch Debian from stable to testing mode. Up to this point, we had no difficulties, just some slowness running the commands `apt update`, `apt upgrade`, and installing dependencies (`pkg-perl-tools`, `debian-policy`, `git-buildpackage`, etc.).

During tutorial 1, everything went smoothly, and we followed all the steps without any issues. Moving on to tutorial 2, the library we chose was `Module::Generic`, and the choice was completely random since we were not familiar with any Perl libraries and did not know the implications of each choice. Thus, following the steps described in the tutorial, we completed the copyright templates and rewrote the module's description without any problem. The first difficulties began to appear in the `debian/control` file.

When we ran the command `cme check dpkg-control debian/control`, we noticed warnings that did not appear in the tutorials. They indicated that some dependencies had redundant version requirements (e.g., `Test::More >= 1.2.3`) that could be removed. We fixed these warnings and then ran the `BUILDER=pbuilder git-pbuilder` command, which was the source of all subsequent problems.

At first, the command did not even reach the module tests because it said that certain dependencies described in the `debian/control` file were virtual packages. It took us some time to understand what this meant and what we should do, but eventually we realized that we just needed to remove them from `debian/control` to proceed. After removing these files and running the tests, we noticed that several cases failed, and the reason was missing dependencies. We discovered that to install the dependencies, we just needed to use the command `cpan <dependency name>`, but the problem was that for some of them, the program could not find and therefore could not install them. After some time, we saw that it was possible to manually install dependencies by downloading them directly from [https://metacpan.org](https://metacpan.org).

After installing all the missing dependencies, we ran the builder again, and the warnings still indicated that dependencies were not installed. We discovered that the directories with the new dependencies were not updated inside the chroot, so for pbuilder, nothing new had been installed. To solve this, we added the directories to be mounted (inside the chroot) to the pbuilder configuration file (`.pbuilderrc`). This way, the tests stopped warning about missing dependencies.

Now, only one test was failing, and we continued trying to understand why it was failing. When we ran it directly on the virtual machine, outside of pbuilder, all the tests passed, but when running inside the chroot, this test always failed. Talking to Joenio, the author of the tutorial, we discovered that the problem was indeed upstream, and to package this library, we would first need to fix the bug. This marked the end of our experience with Debian packaging.
